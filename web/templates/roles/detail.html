{% extends 'base/base.html' %}
{% block title %}Role - {{ role.name }}{% endblock %}
{% block content %}
<div class="page-head"><h1>Role: {{ role.name }}</h1><a class="btn" href="/roles/" data-testid="back-roles">Back</a></div>
<div class="card" data-testid="role-detail">
  <h3>Modules & Permissions</h3>
  <table class="table" data-testid="role-modules-table">
    <thead><tr><th>Module</th><th>Category</th><th>Permissions</th></tr></thead>
    <tbody>
    {% for rm in role.role_modules %}
      <tr>
        <td>{{ rm.module.name }}</td>
        <td>{{ rm.module.category }}</td>
        <td>
          {% for p in rm.permissions %}
            <span class="tag" data-testid="perm-{{ p.codename }}">{{ p.codename }}</span>
          {% empty %}<span class="muted">None</span>{% endfor %}
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="3" class="empty" data-testid="role-modules-empty">No modules linked</td></tr>
    {% endfor %}
    </tbody>
  </table>
  <a class="btn btn-primary" href="/roles/{{ role.id }}/edit/" data-testid="role-edit-btn">Edit Role</a>
</div>
{% endblock %}
